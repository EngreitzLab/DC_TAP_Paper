Loading in packages
Loading input files
Rows: 16207 Columns: 12
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
chr (8): chr, name, strand, spacer, target_chr, target_name, target_strand, ...
dbl (4): start, end, target_start, target_end

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Preparing gene and perturbation coordinates
Calculating distances efficiently by chromosome
Processing chromosome: chr1
Processing chromosome: chr10
Processing chromosome: chr11
Processing chromosome: chr12
Processing chromosome: chr15
Processing chromosome: chr16
Processing chromosome: chr17
Processing chromosome: chr18
Processing chromosome: chr19
Processing chromosome: chr2
Processing chromosome: chr20
Processing chromosome: chr3
Processing chromosome: chr5
Processing chromosome: chr6
Processing chromosome: chr7
Processing chromosome: chr8
Combining all pairs
Adding target type information
Saving distance information for filtered pairs
Reporting all missing pairs
Found 45 targets without any genes within 2MB:

Breakdown by target type:

        DE        enh    tss_pos tss_random 
         1         40          3          1 

Full list of targets without genes:
                 target_name target_type
1                  MESP1_TSS     tss_pos
2    chr20:31879690-31879991         enh
3    chr20:31886960-31887261         enh
4    chr20:32030986-32031287         enh
5    chr20:32032751-32033052         enh
6    chr20:32045016-32045317         enh
7    chr20:32250958-32251259         enh
8    chr20:32251375-32251676         enh
9    chr20:32255749-32256050         enh
10   chr20:32272856-32273343         enh
11   chr20:32319874-32320175         enh
12   chr20:32420044-32420345         enh
13   chr20:32450457-32450758         enh
14   chr20:32450855-32451156         enh
15                EIF2S2_TSS  tss_random
16   chr20:32700662-32700963         enh
17   chr20:32778443-32778744         enh
18   chr20:32803896-32804197         enh
19   chr20:32856722-32857023         enh
20   chr20:32857166-32857467         enh
21   chr20:32888873-32889174         enh
22   chr20:33061127-33061428         enh
23   chr20:33064109-33064410         enh
24   chr20:33124835-33125136         enh
25   chr20:33126479-33126780         enh
26   chr20:33150483-33150784         enh
27   chr20:33292647-33292948         enh
28   chr20:33293220-33293521         enh
29   chr20:33412219-33412520         enh
30   chr20:33412870-33413171         enh
31   chr20:33539434-33539735         enh
32   chr20:33542714-33543015         enh
33   chr20:33548638-33548939         enh
34   chr20:33586228-33586529         enh
35   chr20:33590784-33591085         enh
36   chr20:33592563-33592864         enh
37   chr20:33593303-33593604         enh
38   chr20:33595320-33595621         enh
39   chr20:33796219-33796520         enh
40   chr20:33814855-33815156         enh
41   chr20:33857109-33857410         enh
42   chr20:33861282-33861583         enh
43 KCNH2_DE_1_AND_KCNH2_DE_2          DE
44               KCNH2_TSS_1     tss_pos
45               KCNH2_TSS_2     tss_pos

Found 28 genes without any targets within 2MB:
              gene gene_name gene_chr gene_start  gene_end
1  ENSG00000120948    TARDBP     chr1   11072401  11072401
2  ENSG00000197956    S100A6     chr1  153508720 153508720
3  ENSG00000196504   PRPF40A     chr2  153574511 153574511
4  ENSG00000174695  TMEM167A     chr5   82373682  82373682
5  ENSG00000135597     REPS1     chr6  139309398 139309398
6  ENSG00000105835     NAMPT     chr7  105926772 105926772
7  ENSG00000128610     FEZF1     chr7  121950745 121950745
8  ENSG00000187866   FAM122A     chr9   71394981  71394981
9  ENSG00000156017   CARNMT1     chr9   77643339  77643339
10 ENSG00000148634     HERC4    chr10   69835105  69835105
11 ENSG00000095564     BTAF1    chr10   93683527  93683527
12 ENSG00000166452     AKIP1    chr11    8932686   8932686
13 ENSG00000168496      FEN1    chr11   61560383  61560383
14 ENSG00000135679      MDM2    chr12   69201957  69201957
15 ENSG00000125245     GPR18    chr13   99913998  99913998
16 ENSG00000179409    GEMIN4    chr17     657239    657239
17 ENSG00000178691     SUZ12    chr17   30264026  30264026
18 ENSG00000134758    RNF138    chr18   29671837  29671837
19 ENSG00000141646     SMAD4    chr18   48554764  48554764
20 ENSG00000074657    ZNF532    chr18   56529832  56529832
21 ENSG00000141682    PMAIP1    chr18   57567180  57567180
22 ENSG00000129951    PLPPR3    chr19     821977    821977
23 ENSG00000198521     ZNF43    chr19   22034927  22034927
24 ENSG00000128626    MRPS12    chr19   39421188  39421188
25 ENSG00000105323  HNRNPUL1    chr19   41768401  41768401
26 ENSG00000124222     STX16    chr20   57226309  57226309
27 ENSG00000100372  SLC25A17    chr22   41215403  41215403
28 ENSG00000182195     LDOC1     chrX  140271314 140271314
Genes, which aren't negative control genes, that weren't paired up with any target within 2Mb
character(0)
Guides in the guide_targets file that aren't in perturb_status matrix: 
# A tibble: 6 × 2
  grna_id                        grna_target              
  <chr>                          <chr>                    
1 WTC11_Random_Screen_Crop_2422  BAG3_TSS                 
2 WTC11_Random_Screen_Crop_7289  ROCK1_TSS                
3 WTC11_Random_Screen_Crop_14743 KCNH2_DE_1_AND_KCNH2_DE_2
4 WTC11_Random_Screen_Crop_14745 KCNH2_DE_1_AND_KCNH2_DE_2
5 WTC11_Random_Screen_Crop_14747 KCNH2_DE_1_AND_KCNH2_DE_2
6 WTC11_Random_Screen_Crop_14749 KCNH2_DE_1_AND_KCNH2_DE_2
Warning messages:
1: In obtain_pointer_vector(i = dt$i, dim = n_responses) :
  subscript out of bounds (index 23718114 >= vector size 23718114)
2: In obtain_pointer_vector(i = dt$i, dim = n_responses) :
  subscript out of bounds (index 5519876 >= vector size 5519876)
An object of class sceptre_object.

Attributes of the data:
	• 180116 cells
	• 198 responses
	• High multiplicity-of-infection 
	• 15401 targeting gRNAs (distributed across 1043 targets) 
	• 800 non-targeting gRNAs 
	• 5 covariates (batch, grna_n_nonzero, grna_n_umis, response_n_nonzero, response_n_umis)

Analysis status:
	✓ import_data()
	✓ set_analysis_parameters()
	✗ assign_grnas()
	✗ run_qc()
	✗ run_calibration_check()
	✗ run_power_check()
	✗ run_discovery_analysis()

Analysis parameters: 
	• Discovery pairs: data frame with 6836 pairs
	• Positive control pairs: data frame with 0 pairs
	• Sidedness of test: both
	• Resampling mechanism: conditional resampling
	• gRNA integration strategy: union
	• Resampling approximation: skew normal
	• Multiple testing adjustment: BH at level 0.1
	• N nonzero treatment cells threshold: not specified
	• N nonzero control cells threshold: not specified
	• Formula object: log(response_n_nonzero) + log(response_n_umis) + log(grna_n_nonzero + 1) + log(grna_n_umis + 1)Saving output files
Closing log file
